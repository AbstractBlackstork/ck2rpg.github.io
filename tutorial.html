<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using the CK3 Procedural Map Generator: A Step-by-Step Guide</title>
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 40px auto;
            padding: 30px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 20px;
            margin: 0;
            font-size: 2.5em;
            font-weight: 600;
            color: #333;
        }

        .content h2 {
            font-size: 1.8em;
            color: #555;
            border-bottom: 2px solid #ccc;
            padding-bottom: 10px;
            margin-top: 30px;
            transition: color 0.3s, border-bottom 0.3s;
        }
        .content h2:hover {
            color: #333;
            border-bottom: 2px solid #999;
        }
        p {
            margin-bottom: 20px;
        }
        code {
            background: #e0e0e0;
            color: #333;
            padding: 2px 5px;
            border-radius: 3px;
        }
        .note {
            background: #f9f9f9;
            color: #333;
            padding: 15px;
            border-left: 5px solid #ccc;
            margin-bottom: 20px;
            border-radius: 3px;
        }
        footer {
            text-align: center;
            padding: 20px 0;
            background: #fff;
            color: #777;
            border-top: 1px solid #ddd;
            margin-top: 40px;
        }
        footer p {
            margin: 0;
        }
        .step-list {
            list-style-type: none;
            padding-left: 0;
            margin-bottom: 20px;
        }
        .step-list li {
            background: #f0f0f0;
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
            transition: background 0.3s, transform 0.3s;
        }
        .step-list li:hover {
            background: #e0e0e0;
            transform: translateX(5px);
        }
         /* Header */
        header {
            background: #333;
            color: #fff;
            padding-top: 10px;
            min-height: 70px;
            border-bottom: #F8F4E3 3px solid;
            font-size: 0.8em;
        }
        
        header a {
            color: #fff;
        }
        
        header ul {
            display: flex;
            list-style: none;
            justify-content: flex-end;
        }
        
        header ul li {
            margin: 0 20px;
        }
        
        header h1 {
            float: left;
            margin: 0;
        }
        .hamburger {
            display: none;
            cursor: pointer;
            position: absolute;
            top: 10px;
            right: 10px;
        }
        
        .hamburger span {
            display: block;
            width: 25px;
            height: 3px;
            margin: 5px auto;
            background-color: #fff;
            transition: all 0.3s ease-in-out;
        }
        
        /* Mobile Navigation */
        @media (max-width: 768px) {
            .hamburger {
            display: block;
            }
        
            #nav-links {
            width: 100%;
            background: #333;
            display: none;
            flex-direction: column;
            align-items: center;
            }
        
            #nav-links li {
            margin: 15px 0;
            }
        
            #nav-links li a {
            color: #fff;
            }
        
            #nav-links.active {
            display: flex;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
        <ul id="nav-links">
            <li><a href="https://ck2rpg.github.io">About</a></li>
            <li><a href="https://ck2rpg.github.io/index.html#mods">Examples</a></li>
            <li><a href="https://ck2rpg.github.io/tutorial.html">Tutorial</a></li>
            <li><a href="docs/global.html">Docs</a></li>
            <li><a href="https://ck2rpg.github.io/index.html#collaborations">Team</a></li>
            <li><a href="https://ck2rpg.github.io/index.html#skills">Join</a></li>
            <li><a href="https://discord.gg/eemRxbCUX3">Discord</a></li>
        </ul>
        </nav>
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </header>
    <h1>Using the CK3 Procedural Map Generator: A Step-by-Step Guide</h1>
    <div class="container">
        <div class="content">
            <h2>Introduction</h2>
            <p>This guide will walk you through the process of setting up and using the CK3 Procedural Map Generator. Follow the steps carefully to ensure a smooth experience.</p>

            <h2>Step 0: Gimp and Browser Settings</h2>
            <ul class="step-list">
                <li>Download the Gimp image editing program. It is open source and necessary for post-processing. You need to set two options in your browser settings. First, set the download options to save files to your replacer folder (see Step 3). Second, ensure that you have allowed multiple downloads because the program will be saving multiple files at once. If you do not set this, it sometimes can fail silently and cause major headaches for you.</li>
            </ul>

            <h2>Step 1: Create a Mod Folder</h2>
            <ul class="step-list">
                <li>Open the CK3 launcher.</li>
                <li>Create a new mod folder. Do not upload it to Workshop yet.</li>
            </ul>

            <h2>Step 2: Copy Required Files</h2>
            <ul class="step-list">
                <li>Subscribe to the <a href="https://steamcommunity.com/sharedfiles/filedetails/?id=3279283062">template mod if you have not done so already. For those without Steam access, I am working on a solution.</a>.</li>
                <li>Copy and paste the files from the template mod folder (in your Steam workshop file directory) to your created mod (in your mods directory). Overwrite the descriptor.</li>
                <li>Edit the descriptor file in your created mod folder to add the name of your mod and remove the existing "remote_file_id" line or add a remote file id if you've already uploaded your mod to workshop.</li>
                </li>
                <li class="note"><strong>Note:</strong> The generator does not currently create folder structures, so this step is necessary.</li>
            </ul>

            <h2>Step 3: Create a "Replacers" Folder</h2>
            <ul class="step-list">
                <li>In the top-level folder of your new mod folder, create a folder named <code>replacers</code>. As stated in Step 0, you <em>must</em> save all generated files to this folder or move them here after generation.</li>
            </ul>

            <h2>Step 4: Access the Generator</h2>
            <ul class="step-list">
                <li>Go to <a href="ck2rpg.github.io">ck2rpg.github.io</a></li>
                <li>Click on the "Go to Generator" button.</li>
                <li class="note"><strong>Recommended Browser:</strong> Use Microsoft Edge. While I prefer other browsers, Edge currently performs better for this tool.</li>
            </ul>

            <h2>Step 5: Generate World</h2>
            <ul class="step-list">
                <li>Click the "Generate a New World" button. Edit it as you see fit using the tools in the toolbox that appears.</li>
            </ul>

            <h2>Step 6: Generate Provinces</h2>
            <ul class="step-list">
                <li>Click on "Generate Provinces".</li>
                <li class="note">This will take approximately two and a half minutes. A tracker tracks the progress. The generated file will save immediately upon completion.</li>
            </ul>

            <h2>Step 7: Download Text Files</h2>
            <ul class="step-list">
                <li>The next screen will ask you which text files you want to download. Click the files you desire (suggested and default is all). When you click download, you will see multiple files downloading.</li>
            </ul>

            <h2>Step 8: Download Image Files</h2>
            <ul class="step-list">
                <li>Now you will have the opportunity to select image files to download. For now, keep the default selection of all.</li>
            </ul>

            <h2>Step 9: Post-Processing with Gimp</h2>
            <ul class="step-list">
                <li>Go to the <a href="https://github.com/ck2rpg/mapgenpostprocessor/blob/main/gimpscript.py">Gimp Post-Processing Script</a> and copy it.</li>
                <li>Change the process_folder method call at the very end of the file to point to the <code>replacers</code> folder you created in Step 3. It will not work unless you do this.</li>
                <li>Open Gimp and navigate to Filters > Python-Fu > Console.</li>
                <li>Paste the edited post-processing script, now correctly pointing to your <code>replacers</code> folder, into the Python-Fu console and press enter.</li>
                <li class="note">This script applies a Gaussian blur, formats files, and places them in the correct folders. You can watch the progress in the status bar at the bottom of Gimp. When it is done, the console should give you a new line. Be patient, it takes a minute or two.</li>
            </ul>

            <h2>Step 10: Move Files to the Correct Locations</h2>
            <ul class="step-list">
                <li>Open the <code>movetomapobjectdata</code> folder in your mod folder (which has been copied from the template).</li>
                <li>Copy all files and paste them into <code>modname/gfx/map/map_object_data</code> to overwrite existing files.</li>
            </ul>

            <h2>Step 11: Handle Rivers File Manually</h2>
            <ul class="step-list">
                <li>Open rivers.png in Gimp from the replacers folder. Open the existing rivers.png in the map_data folder. Copy and paste the generated rivers.png over the existing rivers.png in the map_data folder. Ensure you overwrite the template file in Gimp to ensure proper indexing.</li>
            </ul>

            <h2>Step 12: Handle Flatmap Manually</h2>
            <ul class="step-list">
                <li>Open the <code>papyrus.png</code> file in the <code>replacers</code> folder.</li>
                <li>Adjust brightness and apply a sepia filter if desired.</li>
                <li>Apply a Gaussian blur with a radius of 7.5.</li>
                <li>Paste it over and overwrite the <code>flatmap.dds</code> file in <code>gfx/map/terrain/</code>.</li>
            </ul>

            <h2>Step 13: Finalize in the Map Editor and Debug mode.</h2>
            <ul class="step-list">
                <li>Open the map editor (right-click Crusader Kings 3 in Steam, click properties, and set launch options to <code>-mapeditor</code>).</li>
                <li>Repack the map and save it to your mod folder.</li>
                <li>Delete any files at documents/paradox interactive/crusader kings 3/generated.</li>    
                <li>Change launch options to <code>-debug_mode</code> and start the game. Pick a ruler and start. Then close the game to generate locators.</li>
                    <li>Copy the generated locators from <code>documents/paradox interactive/crusader kings 3/generated</code> to <code>gfx/map/map_object/data</code>.</li>
                </ul>
    
                <h2>Conclusion</h2>
                <p>By following these steps, you should have a working generated world in Crusader Kings III.</p>
            </div>
        </div>
        <footer>
            
        </footer>
        <script src="js/interface/index.js"></script>
    </body>
    </html>